"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const authService = require("../../services/Auth");
async function login(req, res, next) {
    try {
        const token = await authService.login(req.body.email, req.body.password);
        res.header('Access-Control-Expose-Headers', 'X-Token');
        res.setHeader('X-Token', token);
        res.status(200).json({ token });
    }
    catch (err) {
        errorHandler(err, res, next);
    }
}
exports.login = login;
function errorHandler(err, res, next) {
    switch (err.message) {
        case 'user-not-found':
            return res.status(404).send({ message: 'Usuário não encontrado' });
        case 'user-inactive':
            return res.status(403).send({ message: 'Usuário inativo' });
        case 'invalid-password':
            return res.status(400).send({ message: 'Senha inválida' });
        default:
            next(err);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWN0aW9ucy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NlcnZlci9hZG1pbi9yb3V0ZXMvYXV0aC9hY3Rpb25zLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQ0EsbURBQW1EO0FBRTVDLEtBQUssZ0JBQWdCLEdBQVksRUFBRSxHQUFhLEVBQUUsSUFBa0I7SUFDdkUsSUFBSSxDQUFDO1FBQ0QsTUFBTSxLQUFLLEdBQUcsTUFBTSxXQUFXLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxFQUFFLEdBQUcsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDekUsR0FBRyxDQUFDLE1BQU0sQ0FBQywrQkFBK0IsRUFBRSxTQUFTLENBQUMsQ0FBQztRQUN2RCxHQUFHLENBQUMsU0FBUyxDQUFDLFNBQVMsRUFBRSxLQUFLLENBQUMsQ0FBQztRQUNoQyxHQUFHLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7SUFDcEMsQ0FBQztJQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUM7UUFDWCxZQUFZLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUNqQyxDQUFDO0FBQ0wsQ0FBQztBQVRELHNCQVNDO0FBRUQsc0JBQXNCLEdBQVUsRUFBRSxHQUFhLEVBQUUsSUFBa0I7SUFDakUsTUFBTSxDQUFDLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDcEIsS0FBSyxnQkFBZ0I7WUFDbkIsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsT0FBTyxFQUFFLHdCQUF3QixFQUFFLENBQUMsQ0FBQztRQUNyRSxLQUFLLGVBQWU7WUFDbEIsTUFBTSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsT0FBTyxFQUFFLGlCQUFpQixFQUFFLENBQUMsQ0FBQztRQUM5RCxLQUFLLGtCQUFrQjtZQUNyQixNQUFNLENBQUMsR0FBRyxDQUFDLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxJQUFJLENBQUMsRUFBRSxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsQ0FBQyxDQUFDO1FBQzdEO1lBQ0UsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2QsQ0FBQztBQUNILENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0RnVuY3Rpb24sIFJlcXVlc3QsIFJlc3BvbnNlIH0gIGZyb20gJ2V4cHJlc3MnO1xuaW1wb3J0ICogYXMgYXV0aFNlcnZpY2UgZnJvbSAnLi4vLi4vc2VydmljZXMvQXV0aCc7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBsb2dpbihyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbikgOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgICBjb25zdCB0b2tlbiA9IGF3YWl0IGF1dGhTZXJ2aWNlLmxvZ2luKHJlcS5ib2R5LmVtYWlsLCByZXEuYm9keS5wYXNzd29yZCk7ICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgcmVzLmhlYWRlcignQWNjZXNzLUNvbnRyb2wtRXhwb3NlLUhlYWRlcnMnLCAnWC1Ub2tlbicpO1xuICAgICAgICByZXMuc2V0SGVhZGVyKCdYLVRva2VuJywgdG9rZW4pO1xuICAgICAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IHRva2VuIH0pO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICBlcnJvckhhbmRsZXIoZXJyLCByZXMsIG5leHQpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZXJyb3JIYW5kbGVyKGVycjogRXJyb3IsIHJlczogUmVzcG9uc2UsIG5leHQ6IE5leHRGdW5jdGlvbik6IGFueSB7XG4gIHN3aXRjaCAoZXJyLm1lc3NhZ2UpIHtcbiAgICBjYXNlICd1c2VyLW5vdC1mb3VuZCc6XG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDQpLnNlbmQoeyBtZXNzYWdlOiAnVXN1w6FyaW8gbsOjbyBlbmNvbnRyYWRvJyB9KTtcbiAgICBjYXNlICd1c2VyLWluYWN0aXZlJzpcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuc2VuZCh7IG1lc3NhZ2U6ICdVc3XDoXJpbyBpbmF0aXZvJyB9KTtcbiAgICBjYXNlICdpbnZhbGlkLXBhc3N3b3JkJzpcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuc2VuZCh7IG1lc3NhZ2U6ICdTZW5oYSBpbnbDoWxpZGEnIH0pO1xuICAgIGRlZmF1bHQ6XG4gICAgICBuZXh0KGVycik7XG4gIH1cbn1cbiJdfQ==